<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<script type="text/javascript">

$(function () {	
	function setsession(target, params, formid, loginType){
		var data={"sessoinname":"loginType", "sessionval":loginType}
	     $.ajax({
				url : '/com/sessionupdate.do',
				data : data,
				type : 'POST',
				dataType : 'json',
				error : function(jqXHR, textStatus, errorThrown) {
					alert(textStatus + "\r\n" + errorThrown);
				},
				success : function(data) {
					if (data.ISOK) {
						gopage(target, params, formid);
					} else {
						alert(data.MSG);
					}

				}

		});
	}
	
	$('.btn_main_reload').click(function(){
		 var loginType = $(this).attr('ktmp');
		 var target = $(this).attr('url');
		 //var target='/dash/dashboard.do';
	     var formid='searchVO';
	     var params = [];
	     params[0] = JSON.stringify({
	         "inputtype": 'input'
	       , "inputname": 'ktmp'
	       , "inputvalue": loginType
	     });
	     setsession(target, params, formid, loginType);
	     
	});
	
	$('.top_notice_view, .dash_notice_view, .dash_faq_view').click(function(){
		 var target='/man/noticeview.do';
		 if($(this).attr('class') == 'dash_faq_view'){
			 target='/man/faqview.do';
		 }
	     var formid='searchVO';
	     var params = [];
	     params[0] = JSON.stringify({
	         "inputtype": 'input'
	       , "inputname": 'sqno'
	       , "inputvalue": $(this).attr('nseq')
	     });
	     params[1] = JSON.stringify({
	         "inputtype": 'input'
	       , "inputname": 'n_type'
	       , "inputvalue": 'DASH'
	     });
	     gopage(target, params, formid);
	});
	$('.btn_pol_status').click(function(){
		var majCode = $(this).attr('majCode');
		var minCode = $(this).attr('minCode');
		var polCode = $(this).attr('polCode');
		var loginType = $(this).attr('loginType');
		var mtype = $(this).attr('menutype');
		var buseoType = $(this).attr('buseoindc');
		var search_date = $.type($('#search_date').val()) === "undefined" ? "" : $('#search_date').val();
 		var searchPolCondition = $.type($('#searchPolCondition').val()) === "undefined" ? "" : $('#searchPolCondition').val();
 		var searchPolKeyword = $.type($('#searchPolKeyword').val()) === "undefined" ? "" : $('#searchPolKeyword').val();
		 if(mtype == 'T'){
			//메뉴이면
			majCode = $('#mCode').val();
			minCode = $('#nCode').val();
			polCode = $('#pCode').val();
			buseoType = $('#buseoType').val();
			searchPolCondition = "1";
			searchPolKeyword = "";
		 }
		 
		 var target='/pol/policystatus.do';
	     var formid='searchVO';
	     var params = [];
	     params[0] = JSON.stringify({
	         "inputtype": 'input'
	       , "inputname": 'majCode'
	       , "inputvalue": majCode
	     });
	     params[1] = JSON.stringify({
	         "inputtype": 'input'
	       , "inputname": 'minCode'
	       , "inputvalue": minCode
	     });
	     params[2] = JSON.stringify({
	         "inputtype": 'input'
	       , "inputname": 'polCode'
	       , "inputvalue": polCode
	     });
	     params[3] = JSON.stringify({
	         "inputtype": 'input'
	       , "inputname": 'begin_date'
	       , "inputvalue": search_date
	     });
	     params[4] = JSON.stringify({
	         "inputtype": 'input'
	       , "inputname": 'searchCondition'
	       , "inputvalue": searchPolCondition
	     });
	     params[5] = JSON.stringify({
	         "inputtype": 'input'
	       , "inputname": 'searchKeyword'
	       , "inputvalue": searchPolKeyword
	     });
	     params[6] = JSON.stringify({
	    	 "inputtype": 'input'
	  	   , "inputname": 'buseoType'
	  	   , "inputvalue": buseoType
	     })
	     setsession(target, params, formid, loginType);
	     
	});
});
</script>

<div id="header">
    <a href="/dash/home.do"><h1>임직원 보안수준</h1></a>
    <h4>local navigation</h4>
    <ul class="lnb_menu">
        <%=request.getAttribute("topMenu") %>
    </ul>
</div>
<div id="user_info">
	<div class="topnotice"><img src="/img/icon_notice_top.png" /> 
		<%=request.getAttribute("topNotice") %>
	</div>
    <div class="block_user">
    	<img src="/img/icon_user.png" /> <span><%=request.getAttribute("loginName") %></span>님 안녕하세요.
    	<%=request.getAttribute("BtnLoginUserType") %>
    	<a href="/logout.do" class="btn_logout">로그아웃</a></div>
</div>